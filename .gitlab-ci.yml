# ğŸš€ CI/CD para WS-GestÃ£o - GitLab Pages
image: node:20-alpine

stages:
  - build
  - deploy

# 1ï¸âƒ£ Build do projeto
build_project:
  stage: build
  script:
    - npm ci                       # instala dependÃªncias de forma limpa
    - npm run generate-keys         # gera src/app/keys.js a partir do .env
    - npm run build                 # gera public/ para deploy
  artifacts:
    paths:
      - public                      # salva a pasta public para o deploy
  only:
    - main                           # sÃ³ executa na branch main

# 2ï¸âƒ£ Deploy no GitLab Pages
pages:
  stage: deploy
  dependencies:
    - build_project
  script:
    - echo "ğŸ“¦ Deploy GitLab Pages concluÃ­do"
  artifacts:
    paths:
      - public                      # conteÃºdo da pasta public serÃ¡ publicado
  only:
    - main
